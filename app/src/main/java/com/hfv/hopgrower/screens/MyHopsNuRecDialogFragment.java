/** * */package com.hfv.hopgrower.screens;import android.app.AlertDialog;import android.app.AlertDialog.Builder;import android.app.Dialog;import android.content.Context;import android.content.Intent;import android.os.Bundle;import android.support.v4.app.DialogFragment;import android.util.Log;import android.view.View;import android.view.WindowManager;import android.widget.ArrayAdapter;import android.widget.Button;import android.widget.RadioButton;import android.widget.Spinner;import android.widget.TableRow;import android.widget.TextView;import android.widget.Toast;import com.hfv.hopgrower.R;import com.hfv.hopgrower.dbadapter.MyHopsDatabaseAdapter;import com.hfv.hopgrower.dbhelper.HopGrowerDatabaseHelper;import com.hfv.hopgrower.special.HopGrowerToast;import com.hfv.hopgrower.sqlite.VarietiesDao;import com.hfv.hopgrower.sqlite.myhops.MyHopsDao;import java.util.List;/** * @author Robert B. Andrews *         RBA Internet Services, Inc. Strasburg, Virginia *         Copyright 2014  All Rights Reserved */public class MyHopsNuRecDialogFragment extends DialogFragment {    public static final String EXTRA_MESSAGE = "EXTRA_MESSAGE";    HopGrowerDatabaseHelper nuEad;    MyHopsDatabaseAdapter mhDbAdapter;    static Context mCtx;    RadioButton rBinesButton;    RadioButton rHYardButton;    TextView bines;    TextView acreage;    TextView location;    TextView density;    TableRow row_acreage;    TableRow row_bines;    TableRow row_density;    AlertDialog adia;    Spinner variety;    Spinner yearsago;    Spinner trellishgt;    Spinner irrig;    public static final MyHopsNuRecDialogFragment newInstance(Context context, String message) {        MyHopsNuRecDialogFragment f = new MyHopsNuRecDialogFragment();        Bundle bdl = new Bundle();        bdl.putString(EXTRA_MESSAGE, message);        f.setArguments(bdl);        mCtx = context;        return f;    }    /**     * The system calls this only when creating the layout in a dialog.     */    @Override    public Dialog onCreateDialog(Bundle savedInstanceState) {        Builder adBuilder = new Builder(getActivity());        View view = getActivity().getLayoutInflater().inflate(R.layout.mhfrag_main, null);        view.setBackgroundResource(R.drawable.dialogbox);        bines = (TextView) view.findViewById(R.id.bines);        acreage = (TextView) view.findViewById(R.id.acreage);        location = (TextView) view.findViewById(R.id.location);        density = (TextView) view.findViewById(R.id.density);        row_acreage = (TableRow) view.findViewById(R.id.layout_acreage);        row_bines = (TableRow) view.findViewById(R.id.layout_bines);        row_density = (TableRow) view.findViewById(R.id.layout_density);        //spinners set in xml file mhfrag_main.xml        //except varieties        nuEad = new HopGrowerDatabaseHelper(mCtx);        nuEad.onCreate();        VarietiesDao varietyDao = nuEad.getVarietiesDaoSession();        List<String> varietyNames = varietyDao.getVarietiesArrayList();        nuEad.closeDaoSession();        variety = (Spinner) view.findViewById(R.id.variety);        ArrayAdapter<String> dataAdapter = new ArrayAdapter<String>(mCtx, android.R.layout.simple_spinner_item, varietyNames);        dataAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);        variety.setAdapter(dataAdapter);        //Spinner variety        //Spinner trellis        //Spinner irrigation        Button saveMHRec = (Button) view.findViewById(R.id.mh_button_edit);        Button cancel = (Button) view.findViewById(R.id.mh_button_cancel);        rBinesButton = (RadioButton) view.findViewById(R.id.radio1);        rHYardButton = (RadioButton) view.findViewById(R.id.radio2);        yearsago = (Spinner) view.findViewById(R.id.yrplant);        trellishgt = (Spinner) view.findViewById(R.id.trellis_height);        irrig = (Spinner) view.findViewById(R.id.irrigation);        rBinesButton.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View v) {            /*				binesText.setVisibility(View.VISIBLE);				bines.setVisibility(View.VISIBLE);				acreage_text.setVisibility(View.GONE);				acreage.setVisibility(View.GONE);			*/                row_bines.setVisibility(View.VISIBLE);                row_acreage.setVisibility(View.GONE);                row_density.setVisibility(View.GONE);            }        });        rHYardButton.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View v) {				/*				binesText.setVisibility(View.GONE);				bines.setVisibility(View.GONE);				acreageText.setVisibility(View.VISIBLE);				acreage.setVisibility(View.VISIBLE);				*/                row_bines.setVisibility(View.GONE);                row_acreage.setVisibility(View.VISIBLE);                row_density.setVisibility(View.VISIBLE);            }        });        saveMHRec.setOnClickListener(new View.OnClickListener() {            public void onClick(View view) {                //if bines is checked, save variety, location, num of bines,                //trellis height, irrigation                //else variety, location, acreage, density,trellis hgt, irrigation                Long mhRecID = null;                String[] mhStrings = new String[8];                int buttonVal = 0;                String toastString = "";                String yearspast = yearsago.getSelectedItem().toString();                String myLoc = location.getText().toString();                if (yearspast.equals("select")) {                    toastString = "Please select year planted.";                } else if (myLoc == null || myLoc.trim().equals("")) {                    toastString = "Please enter a location";                }                Log.d("HopgGower", "ToastString is: " + toastString);                if (!toastString.trim().equals("")) {                    HopGrowerToast hgToast = new HopGrowerToast(mCtx, toastString, 2);                    Toast theToast = hgToast.getToast();                    theToast.show();                } else {                    mhStrings[0] = yearsago.getSelectedItem().toString();                    mhStrings[1] = variety.getSelectedItem().toString();                    mhStrings[2] = location.getText().toString();                    mhStrings[6] = trellishgt.getSelectedItem().toString();                    mhStrings[7] = irrig.getSelectedItem().toString();                    if (rBinesButton.isChecked()) {                        mhStrings[3] = bines.getText().toString();                        mhStrings[4] = "0";                        mhStrings[5] = "0";                    } else {                        buttonVal = 1;                        mhStrings[3] = "0";                        mhStrings[4] = acreage.getText().toString();                        mhStrings[5] = density.getText().toString();                    }                    mhDbAdapter = new MyHopsDatabaseAdapter(mCtx);                    mhDbAdapter.open();                    MyHopsDao myHopsDao = mhDbAdapter.getMyHopsDaoSession();                    mhRecID = myHopsDao.createMyHops(buttonVal, mhStrings);                    mhDbAdapter.closeDaoSession();                    //now pass the recID in an intent, throw a new activity                    //and display the swipeable interface                    Intent myHopsPagerIntent = new Intent();                    myHopsPagerIntent.putExtra("mhRecID", "NewRec");                    myHopsPagerIntent.setClassName("com.hfv.hopgrower", "com.hfv.hopgrower.activity.MHViewPagerActivity");                    startActivity(myHopsPagerIntent);                }            }        });        cancel.setOnClickListener(new View.OnClickListener() {            public void onClick(View view) {/*            		variety.setSelection(0);            		yearsago.setSelection(0);                	trellishgt.setSelection(0);                	irrig.setSelection(0);                	bines.setText("");                	acreage.setText("");                	location.setText("");                	density.setText("");*/                adia.dismiss();            }        });        adBuilder.setView(view);        adia = adBuilder.create();        adia.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_ADJUST_RESIZE);        adia.getWindow().clearFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN);        adia.setIcon(R.drawable.hop_cone);        adia.setTitle("MyHops - Add New MyHops Entry");        return adia;    }}