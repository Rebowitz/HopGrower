/** * */package com.hfv.hopgrower.activity;import android.content.Intent;import android.os.Bundle;import android.support.v4.app.FragmentTransaction;import android.support.v7.app.AppCompatActivity;import android.util.Log;import android.view.View;import android.view.View.OnClickListener;import android.widget.Button;import com.hfv.hopgrower.R;import com.hfv.hopgrower.screens.GrowLogEditRecordFragment;import com.hfv.hopgrower.screens.GrowLogLeftMainFragment;import com.hfv.hopgrower.screens.GrowLogNewRecordFragment;import com.hfv.hopgrower.screens.GrowLogRightMainFragment;import java.util.HashMap;/** * @author Robert B. Andrews *         RBA Internet Services, Inc. Strasburg, Virginia *         Copyright 2014  All Rights Reserved */public class GrowLogActivity extends AppCompatActivity//	implements GrowLogLeftMainFragment.Callbacks{        implements GrowLogLeftMainFragment.Callbacks, GrowLogRightMainFragment.Callbacks_rightfrag {//public class GrowLogActivity extends ActionBarActivity{	    private boolean mTwoPane;    private Long dbId = Long.valueOf(0);    FragmentTransaction growlogFragmentTransaction;    GrowLogNewRecordFragment fragment;    GrowLogRightMainFragment glRMFragment;    OnClickListener listener2;    Button button2;    public void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        setContentView(R.layout.grow_log);        getSupportActionBar().setTitle(R.string.app_growlog);        if (findViewById(R.id.gl_entries) != null) {            mTwoPane = true;        }        //setActivateOnItemClick == true sets the list to single choice mode        GrowLogLeftMainFragment glLeftMainFrag = new GrowLogLeftMainFragment();        ((GrowLogLeftMainFragment) getSupportFragmentManager().findFragmentById(R.id.growlog)).setActivateOnItemClick(true);        growlogFragmentTransaction = getSupportFragmentManager().beginTransaction();        growlogFragmentTransaction.add(R.id.growlog, glLeftMainFrag);        growlogFragmentTransaction.commit();//			button2 = (Button) findViewById(R.id.saveglentry);//			button2.setOnClickListener(listener2);        final Button button = (Button) findViewById(R.id.addEntry);        button.setOnClickListener(new OnClickListener() {            @Override            public void onClick(View v) {                if (mTwoPane) {                    Bundle arguments = new Bundle();                    arguments.putLong("dbMHId", dbId);                    fragment = new GrowLogNewRecordFragment();                    fragment.setArguments(arguments);                    FragmentTransaction ft = getSupportFragmentManager().beginTransaction();                    ft.replace(R.id.gl_entries, fragment);                    ft.addToBackStack("tag2");                    ft.commit();                    findViewById(R.id.gl_addrec_button).setVisibility(View.GONE);                    findViewById(R.id.gl_saverec_button).setVisibility(View.VISIBLE);                    button2 = (Button) findViewById(R.id.saveglentry);                    button2.setOnClickListener(listener2);                } else {                }            }        });        listener2 = new OnClickListener() {            @Override            public void onClick(View arg0) {                //onclick here is save the growlog record                //we call the submit method of the fragment                //it will return a value to be checked                //values are 0 validated and submitted successfully                //1 failed validation - second spinner reads select                //2 failed validation - second spinner reads other, text box empty                //-1 database error if caught                Log.d("HopGrower", "The onclick listener works for  button2!!");                String rtnval = fragment.saveGrowLogRec();                if (rtnval.equals("saved")) {                    //we need to switch to previous fragment and populate with records from db                    //for the growlog ID we are currently using                    //	onBackPressed();                    onItemSelected(Long.toString(dbId));                    Log.d("HopGrower", "fragment.saveGrowLogRec returns saved!");                } else {                    Log.d("HopGrower", "fragment.saveGrowLogRec returns notsaved.");                }            }        };//			final Button saveGrowLogRec = (Button) findViewById(R.id.addEntry);    }    public void onItemSelected(String id) {        //we want to pass the mhID to the detail fragment RightMainFragment        //and keep it for a AddGrowLogRecord button click        dbId = Long.valueOf(id);        if (mTwoPane) {            Bundle arguments = new Bundle();            arguments.putLong("dbMHId", dbId);            glRMFragment = new GrowLogRightMainFragment(this);            glRMFragment.setArguments(arguments);            getSupportFragmentManager().beginTransaction().replace(R.id.gl_entries, glRMFragment).commit();            findViewById(R.id.addEntry).setVisibility(View.VISIBLE);        } else {            Intent detailIntent = new Intent(this, GrowLogEntriesActivity.class);            detailIntent.putExtra("dbMHId", dbId);            startActivity(detailIntent);        }    }    //this is for loading info into a edit window    public void rightFragOnItemSelected(String id) {        Log.d("HopGrower", "rightFragOnItemSelected called");        Log.d("HopGrower", "Passed in ID is: " + id);        //need to get info from the list in the fragment,        //create the fragment w/ the data loaded        //and put in a fragment transaction        //update backpress if necessary        Bundle glnrbundle = new Bundle();        HashMap<String, String> glnrHM = glRMFragment.getPassHM();        GrowLogEditRecordFragment glNRFrag = new GrowLogEditRecordFragment();        FragmentTransaction ft = getSupportFragmentManager().beginTransaction();        ft.replace(R.id.gl_entries, glNRFrag);        ft.addToBackStack("tag3");        ft.commit();        findViewById(R.id.gl_addrec_button).setVisibility(View.GONE);        findViewById(R.id.gl_saverec_button).setVisibility(View.VISIBLE);        glNRFrag.setData(glnrHM);    }    public void SettingsFragment() {    }//		public interface Callbacks_rightfrag{//			public void rightFragOnItemSelected(String id);//		}    public interface Callbacks {        void onItemSelected(String id);    }    public boolean setButton() {        findViewById(R.id.gl_addrec_button).setVisibility(View.VISIBLE);        findViewById(R.id.gl_saverec_button).setVisibility(View.GONE);        return true;    }    //handles button clicks from growlog delete record buttons    public void onClick(View v) {        Log.d("HopGrower", "Onclick view button id is: " + v.getId());    }}